{"ast":null,"code":"import { SignatureV4 } from \"@smithy/signature-v4\";\nimport { SESSION_TOKEN_HEADER, SESSION_TOKEN_QUERY_PARAM } from \"../constants\";\nexport class SignatureV4S3Express extends SignatureV4 {\n  async signWithCredentials(requestToSign, credentials, options) {\n    const credentialsWithoutSessionToken = getCredentialsWithoutSessionToken(credentials);\n    requestToSign.headers[SESSION_TOKEN_HEADER] = credentials.sessionToken;\n    const privateAccess = this;\n    setSingleOverride(privateAccess, credentialsWithoutSessionToken);\n    return privateAccess.signRequest(requestToSign, options ?? {});\n  }\n  async presignWithCredentials(requestToSign, credentials, options) {\n    const credentialsWithoutSessionToken = getCredentialsWithoutSessionToken(credentials);\n    delete requestToSign.headers[SESSION_TOKEN_HEADER];\n    requestToSign.headers[SESSION_TOKEN_QUERY_PARAM] = credentials.sessionToken;\n    requestToSign.query = requestToSign.query ?? {};\n    requestToSign.query[SESSION_TOKEN_QUERY_PARAM] = credentials.sessionToken;\n    const privateAccess = this;\n    setSingleOverride(privateAccess, credentialsWithoutSessionToken);\n    return this.presign(requestToSign, options);\n  }\n}\nfunction getCredentialsWithoutSessionToken(credentials) {\n  const credentialsWithoutSessionToken = {\n    accessKeyId: credentials.accessKeyId,\n    secretAccessKey: credentials.secretAccessKey,\n    expiration: credentials.expiration\n  };\n  return credentialsWithoutSessionToken;\n}\nfunction setSingleOverride(privateAccess, credentialsWithoutSessionToken) {\n  const id = setTimeout(() => {\n    throw new Error(\"SignatureV4S3Express credential override was created but not called.\");\n  }, 10);\n  const currentCredentialProvider = privateAccess.credentialProvider;\n  const overrideCredentialsProviderOnce = () => {\n    clearTimeout(id);\n    privateAccess.credentialProvider = currentCredentialProvider;\n    return Promise.resolve(credentialsWithoutSessionToken);\n  };\n  privateAccess.credentialProvider = overrideCredentialsProviderOnce;\n}","map":{"version":3,"names":["SignatureV4","SESSION_TOKEN_HEADER","SESSION_TOKEN_QUERY_PARAM","SignatureV4S3Express","signWithCredentials","requestToSign","credentials","options","credentialsWithoutSessionToken","getCredentialsWithoutSessionToken","headers","sessionToken","privateAccess","setSingleOverride","signRequest","presignWithCredentials","query","presign","accessKeyId","secretAccessKey","expiration","id","setTimeout","Error","currentCredentialProvider","credentialProvider","overrideCredentialsProviderOnce","clearTimeout","Promise","resolve"],"sources":["/home/sv/LazyHacks/study-tracker-ui/node_modules/@aws-sdk/middleware-sdk-s3/dist-es/s3-express/classes/SignatureV4S3Express.js"],"sourcesContent":["import { SignatureV4 } from \"@smithy/signature-v4\";\nimport { SESSION_TOKEN_HEADER, SESSION_TOKEN_QUERY_PARAM } from \"../constants\";\nexport class SignatureV4S3Express extends SignatureV4 {\n    async signWithCredentials(requestToSign, credentials, options) {\n        const credentialsWithoutSessionToken = getCredentialsWithoutSessionToken(credentials);\n        requestToSign.headers[SESSION_TOKEN_HEADER] = credentials.sessionToken;\n        const privateAccess = this;\n        setSingleOverride(privateAccess, credentialsWithoutSessionToken);\n        return privateAccess.signRequest(requestToSign, options ?? {});\n    }\n    async presignWithCredentials(requestToSign, credentials, options) {\n        const credentialsWithoutSessionToken = getCredentialsWithoutSessionToken(credentials);\n        delete requestToSign.headers[SESSION_TOKEN_HEADER];\n        requestToSign.headers[SESSION_TOKEN_QUERY_PARAM] = credentials.sessionToken;\n        requestToSign.query = requestToSign.query ?? {};\n        requestToSign.query[SESSION_TOKEN_QUERY_PARAM] = credentials.sessionToken;\n        const privateAccess = this;\n        setSingleOverride(privateAccess, credentialsWithoutSessionToken);\n        return this.presign(requestToSign, options);\n    }\n}\nfunction getCredentialsWithoutSessionToken(credentials) {\n    const credentialsWithoutSessionToken = {\n        accessKeyId: credentials.accessKeyId,\n        secretAccessKey: credentials.secretAccessKey,\n        expiration: credentials.expiration,\n    };\n    return credentialsWithoutSessionToken;\n}\nfunction setSingleOverride(privateAccess, credentialsWithoutSessionToken) {\n    const id = setTimeout(() => {\n        throw new Error(\"SignatureV4S3Express credential override was created but not called.\");\n    }, 10);\n    const currentCredentialProvider = privateAccess.credentialProvider;\n    const overrideCredentialsProviderOnce = () => {\n        clearTimeout(id);\n        privateAccess.credentialProvider = currentCredentialProvider;\n        return Promise.resolve(credentialsWithoutSessionToken);\n    };\n    privateAccess.credentialProvider = overrideCredentialsProviderOnce;\n}\n"],"mappings":"AAAA,SAASA,WAAW,QAAQ,sBAAsB;AAClD,SAASC,oBAAoB,EAAEC,yBAAyB,QAAQ,cAAc;AAC9E,OAAO,MAAMC,oBAAoB,SAASH,WAAW,CAAC;EAClD,MAAMI,mBAAmBA,CAACC,aAAa,EAAEC,WAAW,EAAEC,OAAO,EAAE;IAC3D,MAAMC,8BAA8B,GAAGC,iCAAiC,CAACH,WAAW,CAAC;IACrFD,aAAa,CAACK,OAAO,CAACT,oBAAoB,CAAC,GAAGK,WAAW,CAACK,YAAY;IACtE,MAAMC,aAAa,GAAG,IAAI;IAC1BC,iBAAiB,CAACD,aAAa,EAAEJ,8BAA8B,CAAC;IAChE,OAAOI,aAAa,CAACE,WAAW,CAACT,aAAa,EAAEE,OAAO,IAAI,CAAC,CAAC,CAAC;EAClE;EACA,MAAMQ,sBAAsBA,CAACV,aAAa,EAAEC,WAAW,EAAEC,OAAO,EAAE;IAC9D,MAAMC,8BAA8B,GAAGC,iCAAiC,CAACH,WAAW,CAAC;IACrF,OAAOD,aAAa,CAACK,OAAO,CAACT,oBAAoB,CAAC;IAClDI,aAAa,CAACK,OAAO,CAACR,yBAAyB,CAAC,GAAGI,WAAW,CAACK,YAAY;IAC3EN,aAAa,CAACW,KAAK,GAAGX,aAAa,CAACW,KAAK,IAAI,CAAC,CAAC;IAC/CX,aAAa,CAACW,KAAK,CAACd,yBAAyB,CAAC,GAAGI,WAAW,CAACK,YAAY;IACzE,MAAMC,aAAa,GAAG,IAAI;IAC1BC,iBAAiB,CAACD,aAAa,EAAEJ,8BAA8B,CAAC;IAChE,OAAO,IAAI,CAACS,OAAO,CAACZ,aAAa,EAAEE,OAAO,CAAC;EAC/C;AACJ;AACA,SAASE,iCAAiCA,CAACH,WAAW,EAAE;EACpD,MAAME,8BAA8B,GAAG;IACnCU,WAAW,EAAEZ,WAAW,CAACY,WAAW;IACpCC,eAAe,EAAEb,WAAW,CAACa,eAAe;IAC5CC,UAAU,EAAEd,WAAW,CAACc;EAC5B,CAAC;EACD,OAAOZ,8BAA8B;AACzC;AACA,SAASK,iBAAiBA,CAACD,aAAa,EAAEJ,8BAA8B,EAAE;EACtE,MAAMa,EAAE,GAAGC,UAAU,CAAC,MAAM;IACxB,MAAM,IAAIC,KAAK,CAAC,sEAAsE,CAAC;EAC3F,CAAC,EAAE,EAAE,CAAC;EACN,MAAMC,yBAAyB,GAAGZ,aAAa,CAACa,kBAAkB;EAClE,MAAMC,+BAA+B,GAAGA,CAAA,KAAM;IAC1CC,YAAY,CAACN,EAAE,CAAC;IAChBT,aAAa,CAACa,kBAAkB,GAAGD,yBAAyB;IAC5D,OAAOI,OAAO,CAACC,OAAO,CAACrB,8BAA8B,CAAC;EAC1D,CAAC;EACDI,aAAa,CAACa,kBAAkB,GAAGC,+BAA+B;AACtE","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}